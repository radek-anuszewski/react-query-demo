(this["webpackJsonpreact-query-demo"]=this["webpackJsonpreact-query-demo"]||[]).push([[0],{27:function(e,t,n){"use strict";n.r(t);var c=n(3),r=n.n(c),o=n(19),s=n.n(o),a=n(11),i=n(12),u=n(16),d=n(13),l=n.n(d),j=n(18),b=n(30),h=n(14),m=n(31),f=n(2),p={refetchOnWindowFocus:!1},O=function(){var e=Object(c.useState)({author:"",title:"",message:""}),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(h.b)(),s=Object(m.a)((function(e){return fetch("apis/add",{method:"POST",body:JSON.stringify(n)})}),{onSuccess:function(){o.invalidateQueries("posts",{exact:!0})}}),d=s.mutate,l=s.isSuccess,j=s.reset,b=function(e){return function(t){l&&j(),r((function(n){return Object(i.a)(Object(i.a)({},n),{},Object(a.a)({},e,t.target.value))}))}};return Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),d(n)},children:[Object(f.jsx)("input",{placeholder:"Author",value:n.author,onChange:b("author")}),Object(f.jsx)("input",{placeholder:"Title",value:n.title,onChange:b("title")}),Object(f.jsx)("input",{placeholder:"Message",value:n.message,onChange:b("message")}),Object(f.jsx)("button",{type:"submit",children:"Add comment"}),Object(f.jsx)("br",{}),l&&"post Successfully sent"]})},g=function(e){var t=e.post,n=Object(c.useState)(!1),r=Object(u.a)(n,2),o=r[0],s=r[1];return Object(f.jsxs)("p",{style:{border:"1px solid red",padding:"4px"},children:[Object(f.jsxs)("h4",{children:[t.title,", ",Object(f.jsx)("small",{children:t.author})]}),Object(f.jsx)("div",{children:t.message}),!o&&Object(f.jsx)("button",{onClick:function(){return s(!0)},children:"Show comments"}),o&&Object(f.jsx)("button",{onClick:function(){return s(!1)},children:"Hide comments"}),o&&Object(f.jsx)(x,{postId:t.id})]},t.id)},x=function(e){var t=e.postId,n=Object(b.a)(["comments",t],Object(j.a)(l.a.mark((function e(){var n,c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("apis/comments/".concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return c=e.sent,r=c.comments,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)}))),p),c=n.isFetching,r=n.data;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h5",{children:"Comments"}),c&&"Loading comments...",null===r||void 0===r?void 0:r.map((function(e){return Object(f.jsxs)("div",{style:{border:"3px solid green",margin:"4px",padding:"4px"},children:[Object(f.jsx)("h6",{children:e.author}),Object(f.jsx)("div",{children:e.message})]},e.id)})),Object(f.jsx)(v,{postId:t})]})},v=function(e){var t=e.postId,n=Object(c.useState)({author:"",message:""}),r=Object(u.a)(n,2),o=r[0],s=r[1],d=Object(h.b)(),l=Object(m.a)(["comments",t],(function(e){return fetch("apis/comments/add/".concat(t),{method:"POST",body:JSON.stringify(e)})}),{onSuccess:function(){d.invalidateQueries(["comments",t],{exact:!0})}}),j=l.mutate,b=l.isSuccess,p=l.reset,O=function(e){return function(t){b&&p(),s((function(n){return Object(i.a)(Object(i.a)({},n),{},Object(a.a)({},e,t.target.value))}))}};return Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),j(o)},children:[Object(f.jsx)("input",{placeholder:"Author",value:o.author,onChange:O("author")}),Object(f.jsx)("input",{placeholder:"Message",value:o.message,onChange:O("message")}),Object(f.jsx)("button",{type:"submit",children:"Add comment"}),Object(f.jsx)("br",{}),b&&"comment Successfully sent"]})},w=function(){var e=Object(b.a)("posts",Object(j.a)(l.a.mark((function e(){var t,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("apis");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,c=n.posts,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)}))),p),t=e.isFetching,n=e.data;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h3",{children:"Posts:"}),t&&"Loading posts...",null===n||void 0===n?void 0:n.map((function(e){return Object(f.jsx)(g,{post:e},e.id)})),Object(f.jsx)(O,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function S(e,t){navigator.serviceWorker.register(e).then((function(e){if(!navigator.serviceWorker.controller)return window.location.reload();e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var y=new(n(29).a);s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(h.a,{client:y,children:Object(f.jsx)(w,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/react-query-demo",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){S("".concat("/react-query-demo","/service-worker.js"),e)}))}}()}},[[27,1,2]]]);
//# sourceMappingURL=main.c6ca929e.chunk.js.map